name: contributor
on:
  pull_request:
    types:
      - opened
      - closed


concurrency:
  group: ${{ github.workflow }}-${{ github.event.pull_request.number || github.sha }}
  cancel-in-progress: true

jobs:
  contributor_message:
    runs-on: ubuntu-latest
    steps:
      - name: èŽ·å–token
        uses: actions/create-github-app-token@7e473efe3cb98aa54f8d4bac15400b15fad77d94 # v2.2.0
        id: app-token
        with:
          app-id: ${{ secrets.APP_ID }}
          private-key: ${{ secrets.APP_PRIVATE_KEY }}

      - name: è´¡çŒ®æ¶ˆæ¯
        uses: plbstl/first-contribution@4b2b042fffa26792504a18e49aa9543a87bec077 # v4.1.0
        with:
          token: ${{ steps.app-token.outputs.token }}
          issue-opened-msg: ðŸ‘‹ ä½ å¥½, @{fc-author}ï¼æ„Ÿè°¢ä½ æäº¤äº†ç¬¬ä¸€ä¸ªé—®é¢˜ï¼ðŸ” ä½ çš„ç»†å¿ƒå¸®åŠ©æˆ‘ä»¬å‘çŽ°äº†æ–°çš„æ”¹è¿›æœºä¼šï¼Œæˆ‘ä»¬ä¼šå°½å¿«å¤„ç†ã€‚ðŸš€ å¦‚æžœä½ æœ‰æ›´å¤šçš„æƒ³æ³•æˆ–ç–‘é—®ï¼Œè¯·ç»§ç»­åˆ†äº«ï¼Œæˆ‘ä»¬éžå¸¸ä¹æ„å¬å–ä½ çš„å£°éŸ³ï¼ðŸŒŸ æ„Ÿè°¢ä½ çš„æ”¯æŒï¼
          pr-opened-msg: ðŸ™Œ ä½ å¥½ï¼Œ@{fc-author}ï¼æ„Ÿè°¢ä½ æäº¤çš„ç¬¬ä¸€ä¸ªæ‹‰å–è¯·æ±‚ï¼ðŸ› ï¸ ä½ æ­£åœ¨å¸®åŠ©æˆ‘ä»¬æ‰“é€ æ›´å¥½çš„é¡¹ç›®ï¼Œæˆ‘ä»¬ä¼šè®¤çœŸå®¡æŸ¥å¹¶ä¸Žä½ ä¸€èµ·ä¼˜åŒ–å®ƒã€‚ðŸ’¡ å¦‚æžœä½ æœ‰ä»»ä½•é—®é¢˜æˆ–éœ€è¦å¸®åŠ©ï¼Œéšæ—¶è”ç³»ï¼âœ¨ å¾ˆé«˜å…´ä¸Žä½ åˆä½œï¼Œæ¬¢è¿Žæˆä¸ºæˆ‘ä»¬ç¤¾åŒºçš„ä¸€å‘˜ï¼
          issue-reactions: eyes, heart
          pr-reactions: +1, rocket, heart

  add-contributor:
    if: github.event.pull_request.merged == true
    runs-on: ubuntu-latest
    steps:
      - name: èŽ·å–token
        uses: actions/create-github-app-token@7e473efe3cb98aa54f8d4bac15400b15fad77d94 # v2.2.0
        id: app-token
        with:
          app-id: ${{ secrets.APP_ID }}
          private-key: ${{ secrets.APP_PRIVATE_KEY }}

      - name: æ·»åŠ è´¡çŒ®è€…
        uses: plbstl/first-contribution@4b2b042fffa26792504a18e49aa9543a87bec077 # v4.1.0
        with:
          token: ${{ steps.app-token.outputs.token }}
          pr-merged-msg: >
            @all-contributors please add @{fc-author} for code
